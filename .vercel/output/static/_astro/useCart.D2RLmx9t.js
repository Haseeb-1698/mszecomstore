import{r as u}from"./index.DK-fsZOb.js";const w=[{slug:"netflix",name:"Netflix",description:"Stream unlimited movies and TV shows.",longDescription:"Netflix is a streaming service that offers a wide variety of award-winning TV shows, movies, anime, documentaries, and more on thousands of internet-connected devices. You can watch as much as you want, whenever you want without a single commercial â€“ all for one low monthly price.",price:"PKR 1,500/mo",logo:"/icons/netflix.svg",pricingTiers:[{name:"Basic",price:"PKR 1,200/mo",quality:"SD (480p)"},{name:"Standard",price:"PKR 1,800/mo",quality:"HD (1080p)"},{name:"Premium",price:"PKR 2,400/mo",quality:"UHD (4K) + HDR"}]},{slug:"spotify",name:"Spotify",description:"Music for everyone. Ad-free listening.",longDescription:"Spotify is a digital music, podcast, and video service that gives you access to millions of songs and other content from creators all over the world. Basic functions are free, but you can also choose to upgrade to Spotify Premium.",price:"PKR 1,300/mo",logo:"/icons/spotify.svg",pricingTiers:[{name:"Individual",price:"PKR 1,300/mo",quality:"320kbps"},{name:"Duo",price:"PKR 1,800/mo",quality:"320kbps"},{name:"Family",price:"PKR 2,000/mo",quality:"320kbps"}]},{slug:"adobe-creative-cloud",name:"Adobe Creative Cloud",description:"The world's best creative apps and services.",longDescription:"Adobe Creative Cloud is a set of applications and services from Adobe Inc. that gives subscribers access to a collection of software used for graphic design, video editing, web development, photography, along with a set of mobile applications and also some optional cloud services.",price:"PKR 6,500/mo",logo:"/icons/adobe-creative-cloud.svg",pricingTiers:[{name:"Photography (20GB)",price:"PKR 1,200/mo",quality:"N/A"},{name:"All Apps",price:"PKR 6,500/mo",quality:"N/A"},{name:"Single App",price:"PKR 2,500/mo",quality:"N/A"}]},{slug:"notion",name:"Notion",description:"The all-in-one workspace for your notes, tasks, wikis, and databases.",longDescription:"Notion is an application that provides components such as notes, databases, kanban boards, wikis, calendars and reminders. Users can connect these components to create their own systems for knowledge management, note taking, data management, project management, among others.",price:"PKR 950/mo",logo:"/icons/notion.svg",pricingTiers:[{name:"Plus",price:"PKR 950/mo",quality:"N/A"},{name:"Business",price:"PKR 1,800/mo",quality:"N/A"},{name:"Enterprise",price:"Contact us",quality:"N/A"}]},{slug:"figma",name:"Figma",description:"The collaborative interface design tool.",longDescription:"Figma is a collaborative web application for interface design, with additional offline features enabled by desktop applications for macOS and Windows. The Figma mobile app for Android and iOS allows viewing and interacting with Figma prototypes in real-time on mobile and tablet devices.",price:"PKR 1,400/mo",logo:"/icons/figma.svg",pricingTiers:[{name:"Professional",price:"PKR 1,400/mo",quality:"N/A"},{name:"Organization",price:"PKR 5,400/mo",quality:"N/A"}]},{slug:"disney-plus",name:"Disney+",description:"The streaming home of your favorite stories.",price:"PKR 950/mo",logo:"/icons/disney-plus.svg",longDescription:"Disney+ is the streaming home of your favorite stories from Disney, Pixar, Marvel, Star Wars, and National Geographic. Watch the latest releases, Original series and movies, classic films, and more.",pricingTiers:[{name:"Basic (With Ads)",price:"PKR 950/mo",quality:"Up to 4K UHD"},{name:"Premium (No Ads)",price:"PKR 1,650/mo",quality:"Up to 4K UHD"}]}],I=()=>`cart_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,P=()=>`item_${Date.now()}_${Math.random().toString(36).substring(2,11)}`,S=e=>{const t=new Date;return{id:I(),customerId:e,items:[],subtotal:0,discount:0,total:0,createdAt:t,updatedAt:t}},y=e=>{const t=e.reduce((o,n)=>o+n.price*n.quantity,0);return{subtotal:t,total:t}},T=e=>{const t=new RegExp(/[\d.]+/).exec(e),o=t?Number.parseFloat(t[0]):0;return Number.isFinite(o)?o:0},R=(e,t,o=0)=>{const n=w.find(l=>l.slug===t);if(!n)throw new Error(`Service with slug ${t} not found`);const d=n.pricingTiers?.[o];if(!d)throw new Error(`Tier index ${o} not found for service ${t}`);const a=T(d.price),m=`${t}-tier-${o}`,g=e.items.findIndex(l=>l.serviceId===t&&l.planId===m);let p;if(g>=0)p=e.items.map((l,C)=>C===g?{...l,quantity:l.quantity+1}:l);else{const l={id:P(),serviceId:t,planId:m,serviceName:n.name,planDuration:d.name,price:a,quantity:1};p=[...e.items,l]}const{subtotal:v,total:h}=y(p);return{...e,items:p,subtotal:v,total:h-e.discount,updatedAt:new Date}},A=(e,t)=>{const o=e.items.filter(a=>a.id!==t),{subtotal:n,total:d}=y(o);return{...e,items:o,subtotal:n,total:d-e.discount,updatedAt:new Date}},F=(e,t,o)=>{if(o<=0)return A(e,t);const n=e.items.map(m=>m.id===t?{...m,quantity:o}:m),{subtotal:d,total:a}=y(n);return{...e,items:n,subtotal:d,total:a-e.discount,updatedAt:new Date}},D=(e,t)=>{const o=Math.max(0,Math.min(t,e.subtotal)),n=e.subtotal-o;return{...e,discount:o,total:n,updatedAt:new Date}},K=(e,t)=>{const n={SAVE10:e.subtotal*.1,SAVE20:e.subtotal*.2,FIRST100:100,STUDENT50:50,WELCOME15:e.subtotal*.15}[t.toUpperCase()]||0;return D(e,n)},q=e=>({...e,items:[],subtotal:0,discount:0,total:0,updatedAt:new Date}),E=e=>e.items.reduce((t,o)=>t+o.quantity,0),N=e=>e.items.length===0,b="msz_ecom_cart",k=e=>{if(!(typeof globalThis>"u"))try{localStorage.setItem(b,JSON.stringify(e))}catch(t){console.error("Failed to save cart to localStorage:",t)}},x=()=>{if(typeof globalThis>"u")return null;try{const e=localStorage.getItem(b);if(!e)return null;const t=JSON.parse(e);return{...t,createdAt:new Date(t.createdAt),updatedAt:new Date(t.updatedAt)}}catch(e){return console.error("Failed to load cart from localStorage:",e),null}},U=()=>{if(!(typeof globalThis>"u"))try{localStorage.removeItem(b)}catch(e){console.error("Failed to remove cart from localStorage:",e)}},$=e=>{const t=e.items.filter(n=>!!w.find(a=>a.slug===n.serviceId)),{subtotal:o}=y(t);return{...e,items:t,subtotal:o,total:o-e.discount,updatedAt:new Date}},c={create:S,addItem:R,removeItem:A,updateQuantity:F,applyDiscount:D,applyDiscountCode:K,clear:q,getItemCount:E,isEmpty:N,save:k,load:x,remove:U,validate:$},_=()=>{const[e,t]=u.useState(()=>c.create()),[o,n]=u.useState(!0),[d,a]=u.useState(null);u.useEffect(()=>{(()=>{console.log("ðŸ›’ loadCart started");try{const i=c.load();console.log("ðŸ›’ savedCart from storage:",i);let r=c.create();if(console.log("ðŸ›’ empty cart created:",r),i){const f=c.validate(i);console.log("ðŸ›’ validatedCart:",f),r=f}if(r.items.length===0){console.log("ðŸ›’ Cart empty, adding dummy items...");try{r=c.addItem(r,"netflix",1),console.log("ðŸ›’ After adding netflix:",r)}catch(f){console.error("ðŸ›’ Failed to add dummy item:",f)}}t(r),console.log("ðŸ›’ setCart called"),a(null)}catch(i){console.error("ðŸ›’ loadCart error:",i),a("Failed to load your cart. Starting with an empty cart."),t(c.create())}finally{console.log("ðŸ›’ Setting isLoading to false"),n(!1)}})()},[]),u.useEffect(()=>{if(!o)try{c.save(e),a(null)}catch(s){console.error("Failed to save cart:",s),a("Failed to save your cart.")}},[e,o]);const m=u.useCallback((s,i=0)=>{try{t(r=>c.addItem(r,s,i)),a(null)}catch(r){console.error("Add to cart failed:",r),a(r instanceof Error?r.message:"Failed to add item to cart")}},[]),g=u.useCallback(s=>{try{t(i=>c.removeItem(i,s)),a(null)}catch(i){console.error("Remove from cart failed:",i),a("Failed to remove item from cart")}},[]),p=u.useCallback((s,i)=>{try{t(r=>c.updateQuantity(r,s,i)),a(null)}catch(r){console.error("Update quantity failed:",r),a("Failed to update quantity")}},[]),v=u.useCallback(s=>{try{const i=c.applyDiscountCode(e,s),r=i.discount>e.discount;return r&&(t(i),a(null)),r}catch(i){return console.error("Apply discount failed:",i),a("Failed to apply discount code"),!1}},[e]),h=u.useCallback(()=>{try{t(s=>c.clear(s)),a(null)}catch(s){console.error("Clear cart failed:",s),a("Failed to clear cart")}},[]),l=c.getItemCount(e),C=c.isEmpty(e);return{cart:e,addItem:m,removeItem:g,updateQuantity:p,applyDiscountCode:v,clearCart:h,itemCount:l,isEmpty:C,isLoading:o,error:d}};export{c,_ as u};
